{"version":3,"sources":["tools/ModuleVersion.js"],"names":["createModuleVersionChecker","name","currentVersion","UpdateCacher","Cacher","async","latestVersion","await","pTimeout","latestVersionAsync","checkAsync","getAsync","updateIsAvailable","semver","gt","latest","current"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA;;;;AAEA,SAASA,0BAAT,CAAoCC,IAApC,EAA0CC,cAA1C,EAA0D;AACxD,QAAMC,YAAAA,GAAe,IAAIC,eAAJ,CACnBC,YAAY;AACV,WAAO;AAAEC,MAAAA,aAAa,EAAEC,MAAMC,uBAASC,4BAAmBR,IAAnBQ,CAATD,EAAmC,IAAnCA;AAAvB,KAAP;AACD,GAHkB,EAIlB,GAAEP,IAAK,eAJW,EAKnB,KAAK,EAAL,GAAU,EAAV,GAAe,IALI,CAKJ;AALI,GAArB;;AAQAI,iBAAeK,UAAfL,GAA4B;AAC1B,UAAM;AAAEC,MAAAA;AAAF,QAAoBC,MAAMJ,YAAY,CAACQ,QAAbR,EAAhC;AACA,WAAO;AACLS,MAAAA,iBAAiB,EAAEC,gBAAOC,EAAPD,CAAUP,aAAVO,EAAyBX,cAAzBW,CADd;AAELE,MAAAA,MAAM,EAAET,aAFH;AAGLU,MAAAA,OAAO,EAAEd;AAHJ,KAAP;AAKF;;AAEA,SAAO;AAAEQ,IAAAA;AAAF,GAAP;AACF","file":"../../tools/ModuleVersion.js","sourcesContent":["import latestVersionAsync from 'latest-version';\nimport pTimeout from 'p-timeout';\nimport semver from 'semver';\n\nimport { Cacher } from './FsCache';\n\nfunction createModuleVersionChecker(name, currentVersion) {\n  const UpdateCacher = new Cacher(\n    async () => {\n      return { latestVersion: await pTimeout(latestVersionAsync(name), 2000) };\n    },\n    `${name}-updates.json`,\n    24 * 60 * 60 * 1000 // one day\n  );\n\n  async function checkAsync() {\n    const { latestVersion } = await UpdateCacher.getAsync();\n    return {\n      updateIsAvailable: semver.gt(latestVersion, currentVersion),\n      latest: latestVersion,\n      current: currentVersion,\n    };\n  }\n\n  return { checkAsync };\n}\n\nexport { createModuleVersionChecker };\n"],"sourceRoot":"/@expo/xdl@54.1.5/src"}